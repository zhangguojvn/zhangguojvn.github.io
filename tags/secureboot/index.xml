<?xml version="1.0" encoding="utf-8" standalone="yes"?>
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom" xmlns:content="http://purl.org/rss/1.0/modules/content/">
  <channel>
    <title>SecureBoot on 张某的博客</title>
    <link>https://zhangguojvn.github.io/tags/secureboot/</link>
    <description>Recent content in SecureBoot on 张某的博客</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en</language>
    <lastBuildDate>Sat, 25 Jun 2022 14:50:51 +0800</lastBuildDate><atom:link href="https://zhangguojvn.github.io/tags/secureboot/index.xml" rel="self" type="application/rss+xml" />
    <item>
      <title>将密钥封存至 TPM</title>
      <link>https://zhangguojvn.github.io/posts/seal-the-key-to-the-tpm/</link>
      <pubDate>Sat, 25 Jun 2022 14:50:51 +0800</pubDate>
      
      <guid>https://zhangguojvn.github.io/posts/seal-the-key-to-the-tpm/</guid>
      <description>创建主键 tpm2_createprimary -Q -C o -c ~/tpm/primary.context 创建当前 TPM 的签名 （可选） pcr_bank 可选 sha1 sha256 pcr_id 功能如下表,一般来说 &amp;ldquo;0,1,3,7&amp;rdquo; 即可
PCR USE NOTES PCR0 核心系统固件可执行代码（又名固件） 如果您升级 UEFI，可能会发生变化 PCR1 核心系统固件数据（又名 UEFI 设置） PCR2 扩展或可插入的可执行代码 PCR3 扩展或可插拔固件数据 在 Boot Device Select UEFI 引导阶段设置 PCR4 引导管理器代码和引导尝试 测量引导管理器和固件尝试从中引导的设备 PCR5 引导管理器配置和数据 可以测量引导加载程序的配置；包括 GPT 分区表 PCR6 从 S4 和 S5 电源状态事件恢复 PCR7 安全启动状态 包含 PK/KEK/db 的全部内容，以及用于验证每个启动应用程序的特定证书 PCR8 内核命令行的哈希 由grub和systemd-boot支持 PCR9 initrd 的哈希 预定 linux v5.17 PCR10 保留供将来使用 PCR11 BitLocker 访问控制 PCR12 数据事件和高波动事件 PCR13 引导模块详细信息 PCR14 引导权限 PCR15-23 保留供将来使用 tpm2_pcrread -Q &amp;#34;sha256&amp;#34;:&amp;#34;0,1,2,3,7&amp;#34; -o &amp;#34;$TMP&amp;#34;/pcr.</description>
    </item>
    
    <item>
      <title>使用 Grub 构建统一内核映像</title>
      <link>https://zhangguojvn.github.io/posts/building-a-unified-kernel-image-with-grub/</link>
      <pubDate>Sat, 25 Jun 2022 12:40:51 +0800</pubDate>
      
      <guid>https://zhangguojvn.github.io/posts/building-a-unified-kernel-image-with-grub/</guid>
      <description>统一内核映像是单个可执行文件，可以直接从 UEFI 固件启动，或者由引导加载程序自动获取，只需很少或没有配置。
准备 Grub 配置文件 此配置文件和普通 Grub 配置文件一样，一下只是适配我电脑的配置,默认情况下 Grub 的 root 为 (memdisk).
~/SecureBoot/grub.cfg ----- menuentry &amp;#39;Gentoo&amp;#39; --class gentoo --class gnu-linux --class gnu --class os{ insmod all_video linux /vmlinuz root=/dev/sda1 initrd /initramfs.img } 构建 EFI 文件 使用 grub-mkstandalone 构建单一的内核映像, 将命令中的 vmlinuz-5.15.41-gentoo 以及 iniramfs-5.14.41-gentoo 替换为自己的内核及 initramfs.
grub-mkstandalone --direcotry /usr/lib/grub/x86_64-efi --format x86_64-efi --disable-shim-lock --output grub.efi /vmlinuz=/boot/vmlinuz-5.15.41-gentoo /initramfs.img=/boot/initramfs-5.14.41-gentoo /boot/grub/grub.cfg=~/SecureBoot/grub.cfg 签名 EFI 文件 (可选) 如果使用了安全启动，可以对 EFI 文件进行签名.
sbsign --key ~/keys/db.key --cert ~/keys/db.crt --output grub.</description>
    </item>
    
    <item>
      <title>自签名安全启动 Grub 设置</title>
      <link>https://zhangguojvn.github.io/posts/%E8%87%AA%E7%AD%BE%E5%90%8D%E5%AE%89%E5%85%A8%E5%90%AF%E5%8A%A8-grub-%E8%AE%BE%E7%BD%AE/</link>
      <pubDate>Wed, 20 Apr 2022 03:50:51 +0800</pubDate>
      
      <guid>https://zhangguojvn.github.io/posts/%E8%87%AA%E7%AD%BE%E5%90%8D%E5%AE%89%E5%85%A8%E5%90%AF%E5%8A%A8-grub-%E8%AE%BE%E7%BD%AE/</guid>
      <description>自签名安全启动记录</description>
    </item>
    
  </channel>
</rss>
